%{
% Plot integration error with mesh size
function PlotError(intErrorLDFE,   meshSizeLDFE, ...
                   intErrorQDFE,   meshSizeQDFE, ...
                   intErrorLS,     meshSizeLS, ...
                   intErrorGLC,    meshSizeGLC, ...
                   intErrorQR,     meshSizeQR, ...
                   intErrorLDFEST, meshSizeLDFEST)

% Retrieve information
errLDFE   = intErrorLDFE;
errQDFE   = intErrorQDFE;
errLS     = intErrorLS;
errGLC    = intErrorGLC;
errQR     = intErrorQR;
errLDFEST = intErrorLDFEST;
%}

errLDFE = [ ...
    1.000000000000E+00, ...
8.457254143179E-01, ...
5.037816277452E-01, ...
4.612846276250E-02, ...
1.846328461049E-03, ...
5.430060562455E-03, ...
];

meshSizeLDFE = [ ...
   1.02062E-01, ...
3.40207E-02, ...
2.55155E-02, ...
1.13402E-02, ...
4.86010E-03, ...
2.48932E-03];

errQDFE = [ ...
    3.527122731196E+00, ...
1.488433679037E+00, ...
2.066099317115E-01, ...
2.548446296393E-02, ...
4.396759509069E-02, ...
1.404750987711E-03, ...
2.911002058842E-02];

meshSizeQDFE = [ ...
    6.80414E-02, ...
3.40207E-02, ...
2.26805E-02, ...
1.13402E-02, ...
6.18558E-03, ...
3.24007E-03, ...
2.61698E-03];

errLS = [...
    1.606266704782E+00,...
1.000000000000E+00,...
1.000000000000E+00,...
5.085013437900E+00,...
2.337157667154E+00,...
6.750082839004E-01];

meshSizeLS = [ ...
    2.04124E-01, ...
1.11803E-01, ...
7.71517E-02, ...
5.89256E-02, ...
4.76731E-02, ...
4.00320E-02];

errGLC = [...
    1.000000000000E+00, ...
4.535276381475E-02, ...
3.709938378229E-02, ...
3.780533797290E-03, ...
5.749402432665E-04, ...
1.806558432472E-03, ...
4.821379204956E-04];

meshSizeGLC = [...
    1.11803E-01, ...
3.03170E-02, ...
1.53864E-02, ...
1.03098E-02, ...
7.75217E-03, ...
5.18142E-03, ...
3.89108E-03];

errQR = [...
    3.767866867237E+00, ...
1.000000000000E+00, ...
7.106709940697E-01, ...
6.901116912190E-01, ...
2.253982379240E+00, ...
2.118599285689E-01];

meshSizeQR = [...
   2.04124E-01, ...
1.11803E-01, ...
7.71517E-02, ...
5.89256E-02, ...
4.76731E-02, ...
4.00320E-02];

errLDFEST = [...
    1.000000000000E+00, ...
8.243384617462E-01, ...
5.422276579404E-01, ...
4.623673223108E-01, ...
6.127640359946E-02, ...
3.772698641904E-02, ...
6.247734857441E-03, ...
1.085580701599E-03];

meshSizeLDFEST = [...
    1.76777E-01, ...
8.83883E-02, ...
4.41942E-02, ...
2.20971E-02, ...
1.10485E-02, ...
5.52427E-03, ...
2.76214E-03, ...
1.38107E-03];

errLDFELocal = [ ...
    1.000000000000E+00, ...
5.037816277451E-01, ...
7.311567132301E-02, ...
6.422785572437E-02, ...
2.117329285033E-02, ...
3.989311558107E-03, ...
2.123425271440E-03];

meshSizeLDFELocal = [ ...
    1.44338E-01, ...
1.02062E-01, ...
8.33333E-02, ...
6.29941E-02, ...
4.74579E-02, ...
3.07729E-02, ...
1.79029E-02];

m2 = 2;
b2 = log(errLDFE(1));

m4 = 4;
b4 = log(errLDFELocal(1));

figure
lsPlot = loglog(meshSizeLS, errLS, 'k-s');
set(lsPlot, 'LineWidth', 1.25, 'MarkerSize', 10);
hold on

glcPlot = loglog(meshSizeGLC, errGLC, 'k-o');
set(glcPlot, 'LineWidth', 1.25, 'MarkerSize', 10);
hold on

qrPlot = loglog(meshSizeQR, errQR, 'k-d');
set(qrPlot, 'LineWidth', 1.25, 'MarkerSize', 10);
hold on

ldfestPlot = loglog(meshSizeLDFEST, errLDFEST, 'k-s');
set(ldfestPlot, 'LineWidth', 1.25, 'MarkerSize', 10, 'MarkerFaceColor', 'k');
hold on

ldfePlot = loglog(meshSizeLDFE, errLDFE, 'k-o');
set(ldfePlot, 'LineWidth', 1.25, 'MarkerSize', 10, 'MarkerFaceColor', 'k');
hold on

qdfePlot = loglog(meshSizeQDFE, errQDFE, 'k-d');
set(qdfePlot, 'LineWidth', 1.25, 'MarkerSize', 10, 'MarkerFaceColor', 'k');
hold on

ldfeLocalPlot = loglog(meshSizeLDFELocal, errLDFELocal, 'k-+');
set(ldfeLocalPlot, 'LineWidth', 1.25, 'MarkerSize', 10);
hold on

secondorder = loglog(meshSizeLDFE, exp(m2.*log(meshSizeLDFE / meshSizeLDFE(1)) + b2), 'k--');
set(secondorder, 'LineWidth', 1.25);

fourthorder = loglog(meshSizeLDFELocal, exp(m4.*log(meshSizeLDFELocal / meshSizeLDFELocal(1)) + b4), 'k');
set(fourthorder, 'LineWidth', 1.25);

grid on
set(gca,'FontSize', 18)
xlabel('Mesh Length', 'FontSize', 24)
ylabel('|Relative Error|', 'FontSize', 24)
legend('LS', 'GC', 'QR', 'LDFE-ST', 'LDFE-SQ', 'QDFE-SQ', 'LDFE-SQ Local', '2nd-order', '4th-order', 'Location', 'Southeast')
%legend('LS', 'GC', 'QR', 'LDFE-ST', 'LDFE-SQ', 'QDFE-SQ', '2nd-order', 'Location', 'Southeast')

%end